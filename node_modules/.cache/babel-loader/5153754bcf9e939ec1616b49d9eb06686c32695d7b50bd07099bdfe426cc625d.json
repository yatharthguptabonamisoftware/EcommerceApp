{"ast":null,"code":"import { defineComponent, getCurrentInstance, ref, computed, unref, inject, resolveComponent, openBlock, createBlock, withCtx, createVNode, mergeProps, renderSlot } from 'vue';\nimport '../../roving-focus-group/index.mjs';\nimport '../../../utils/index.mjs';\nimport TwDropdownItemImpl from './dropdown-item-impl.mjs';\nimport { useDropdown } from './useDropdown.mjs';\nimport { TwCollectionItem, dropdownItemProps } from './dropdown.mjs';\nimport { DROPDOWN_INJECTION_KEY } from './tokens.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport ElRovingFocusItem from '../../roving-focus-group/src/roving-focus-item.mjs';\nimport { composeEventHandlers, whenMouse } from '../../../utils/dom/event.mjs';\nconst _sfc_main = defineComponent({\n  name: \"TwDropdownItem\",\n  components: {\n    TwDropdownCollectionItem: TwCollectionItem,\n    ElRovingFocusItem,\n    TwDropdownItemImpl\n  },\n  inheritAttrs: false,\n  props: dropdownItemProps,\n  emits: [\"pointermove\", \"pointerleave\", \"click\"],\n  setup(props, {\n    emit,\n    attrs\n  }) {\n    const {\n      TwDropdown\n    } = useDropdown();\n    const _instance = getCurrentInstance();\n    const itemRef = ref(null);\n    const textContent = computed(() => {\n      var _a, _b;\n      return (_b = (_a = unref(itemRef)) == null ? void 0 : _a.textContent) != null ? _b : \"\";\n    });\n    const {\n      onItemEnter,\n      onItemLeave\n    } = inject(DROPDOWN_INJECTION_KEY, void 0);\n    const handlePointerMove = composeEventHandlers(e => {\n      emit(\"pointermove\", e);\n      return e.defaultPrevented;\n    }, whenMouse(e => {\n      var _a;\n      if (props.disabled) {\n        onItemLeave(e);\n      } else {\n        onItemEnter(e);\n        if (!e.defaultPrevented) {\n          ;\n          (_a = e.currentTarget) == null ? void 0 : _a.focus();\n        }\n      }\n    }));\n    const handlePointerLeave = composeEventHandlers(e => {\n      emit(\"pointerleave\", e);\n      return e.defaultPrevented;\n    }, whenMouse(e => {\n      onItemLeave(e);\n    }));\n    const handleClick = composeEventHandlers(e => {\n      emit(\"click\", e);\n      return e.defaultPrevented;\n    }, e => {\n      var _a, _b, _c;\n      if (props.disabled) {\n        e.stopImmediatePropagation();\n        return;\n      }\n      if ((_a = TwDropdown == null ? void 0 : TwDropdown.hideOnClick) == null ? void 0 : _a.value) {\n        (_b = TwDropdown.handleClick) == null ? void 0 : _b.call(TwDropdown);\n      }\n      (_c = TwDropdown.commandHandler) == null ? void 0 : _c.call(TwDropdown, props.command, _instance, e);\n    });\n    const propsAndAttrs = computed(() => {\n      return {\n        ...props,\n        ...attrs\n      };\n    });\n    return {\n      handleClick,\n      handlePointerMove,\n      handlePointerLeave,\n      textContent,\n      propsAndAttrs\n    };\n  }\n});\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _a;\n  const _component_el_dropdown_item_impl = resolveComponent(\"el-dropdown-item-impl\");\n  const _component_el_roving_focus_item = resolveComponent(\"el-roving-focus-item\");\n  const _component_el_dropdown_collection_item = resolveComponent(\"el-dropdown-collection-item\");\n  return openBlock(), createBlock(_component_el_dropdown_collection_item, {\n    disabled: _ctx.disabled,\n    \"text-value\": (_a = _ctx.textValue) != null ? _a : _ctx.textContent\n  }, {\n    default: withCtx(() => [createVNode(_component_el_roving_focus_item, {\n      focusable: !_ctx.disabled\n    }, {\n      default: withCtx(() => [createVNode(_component_el_dropdown_item_impl, mergeProps(_ctx.propsAndAttrs, {\n        onPointerleave: _ctx.handlePointerLeave,\n        onPointermove: _ctx.handlePointerMove,\n        onClick: _ctx.handleClick\n      }), {\n        default: withCtx(() => [renderSlot(_ctx.$slots, \"default\")]),\n        _: 3\n      }, 16, [\"onPointerleave\", \"onPointermove\", \"onClick\"])]),\n      _: 3\n    }, 8, [\"focusable\"])]),\n    _: 3\n  }, 8, [\"disabled\", \"text-value\"]);\n}\nvar DropdownItem = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { DropdownItem as default };","map":{"version":3,"names":["_sfc_main","defineComponent","name","components","TwDropdownCollectionItem","TwCollectionItem","ElRovingFocusItem","TwDropdownItemImpl","inheritAttrs","props","dropdownItemProps","emits","setup","emit","attrs","TwDropdown","useDropdown","_instance","getCurrentInstance","itemRef","ref","textContent","computed","_a","_b","unref","onItemEnter","onItemLeave","inject","DROPDOWN_INJECTION_KEY","handlePointerMove","composeEventHandlers","e","defaultPrevented","whenMouse","disabled","currentTarget","focus","handlePointerLeave","handleClick","_c","stopImmediatePropagation","hideOnClick","value","call","commandHandler","command","propsAndAttrs","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_component_el_dropdown_collection_item","resolveComponent","openBlock","createBlock","default","withCtx","createVNode","_component_el_roving_focus_item","focusable","_component_el_dropdown_item_impl","mergeProps"],"sources":["/home/bonami/Desktop/Projects/ECommerce/packages/components/dropdown/src/dropdown-item.vue"],"sourcesContent":["<template>\n  <el-dropdown-collection-item\n    :disabled=\"disabled\"\n    :text-value=\"textValue ?? textContent\"\n  >\n    <el-roving-focus-item :focusable=\"!disabled\">\n      <el-dropdown-item-impl\n        v-bind=\"propsAndAttrs\"\n        @pointerleave=\"handlePointerLeave\"\n        @pointermove=\"handlePointerMove\"\n        @click=\"handleClick\"\n      >\n        <slot />\n      </el-dropdown-item-impl>\n    </el-roving-focus-item>\n  </el-dropdown-collection-item>\n</template>\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  getCurrentInstance,\n  inject,\n  ref,\n  unref,\n} from 'vue'\nimport { ElRovingFocusItem } from '@tw-element/components/roving-focus-group'\nimport { composeEventHandlers, whenMouse } from '@tw-element/utils'\nimport TwDropdownItemImpl from './dropdown-item-impl.vue'\nimport { useDropdown } from './useDropdown'\nimport {\n  TwCollectionItem as TwDropdownCollectionItem,\n  dropdownItemProps,\n} from './dropdown'\nimport { DROPDOWN_INJECTION_KEY } from './tokens'\n\nexport default defineComponent({\n  name: 'TwDropdownItem',\n  components: {\n    TwDropdownCollectionItem,\n    ElRovingFocusItem,\n    TwDropdownItemImpl,\n  },\n  inheritAttrs: false,\n  props: dropdownItemProps,\n  emits: ['pointermove', 'pointerleave', 'click'],\n  setup(props, { emit, attrs }) {\n    const { TwDropdown } = useDropdown()\n    const _instance = getCurrentInstance()\n    const itemRef = ref<HTMLElement | null>(null)\n    const textContent = computed(() => unref(itemRef)?.textContent ?? '')\n    const { onItemEnter, onItemLeave } = inject(\n      DROPDOWN_INJECTION_KEY,\n      undefined\n    )!\n\n    const handlePointerMove = composeEventHandlers(\n      (e: PointerEvent) => {\n        emit('pointermove', e)\n        return e.defaultPrevented\n      },\n      whenMouse((e) => {\n        if (props.disabled) {\n          onItemLeave(e)\n        } else {\n          onItemEnter(e)\n          if (!e.defaultPrevented) {\n            ;(e.currentTarget as HTMLElement)?.focus()\n          }\n        }\n      })\n    )\n\n    const handlePointerLeave = composeEventHandlers(\n      (e: PointerEvent) => {\n        emit('pointerleave', e)\n        return e.defaultPrevented\n      },\n      whenMouse((e) => {\n        onItemLeave(e)\n      })\n    )\n\n    const handleClick = composeEventHandlers(\n      (e: PointerEvent) => {\n        emit('click', e)\n        return e.defaultPrevented\n      },\n      (e) => {\n        if (props.disabled) {\n          e.stopImmediatePropagation()\n          return\n        }\n        if (TwDropdown?.hideOnClick?.value) {\n          TwDropdown.handleClick?.()\n        }\n        TwDropdown.commandHandler?.(props.command, _instance, e)\n      }\n    )\n\n    // direct usage of v-bind={ ...$props, ...$attrs } causes type errors\n    const propsAndAttrs = computed(() => {\n      return { ...props, ...attrs }\n    })\n\n    return {\n      handleClick,\n      handlePointerMove,\n      handlePointerLeave,\n      textContent,\n      propsAndAttrs,\n    }\n  },\n})\n</script>\n"],"mappings":";;;;;;;;;;AAoCA,MAAKA,SAAA,GAAaC,eAAA,CAAa;EAC7BC,IAAA,EAAM;EACNC,UAAA,EAAY;IAAAC,wBAAA,EACVC,gBAAA;IACAC,iBAAA;IACAC;EAAA;EAEFC,YAAA,EAAc;EACdC,KAAA,EAAOC,iBAAA;EACPC,KAAA,EAAO,CAAC,eAAe,gBAAgB;EACvCC,MAAMH,KAAA,EAAO;IAAEI,IAAA;IAAMC;EAAA,GAAS;IAC5B,MAAM;MAAEC;IAAA,IAAeC,WAAA;IACvB,MAAMC,SAAA,GAAYC,kBAAA;IAClB,MAAMC,OAAA,GAAUC,GAAA,CAAwB;IACxC,MAAMC,WAAA,GAAcC,QAAA,CAAS,MAAM;MACnC,IAAMC,EAAE,EAAAC,EAAA;MAKR,QAAAA,EAAA,IAAAD,EAAA,GAAAE,KAA0B,CAAAN,OAAA,aACxB,SAAAI,EAAA,CAAAF,WAAA,YAAAG,EAAA;IACE;IACA;MAAAE,WAAA;MAAAC;IAAA,IAAAC,MAAA,CAAAC,sBAAA;IAAS,MAAAC,iBAAA,GAAAC,oBAAA,CAAAC,CAAA;MAGTnB,IAAI,gBAAgBmB,CAAA;MAClB,OAAAA,CAAA,CAAAC,gBAAA;IAAY,GAAAC,SAAA,CAAAF,CAAA;MAEZ,IAAAT,EAAA;MACA,IAAAd,KAAO,CAAA0B,QAAA;QACLR,WAAA,CAAAK,CAAA;MAAC;QAAkCN,WAAA,CAAAM,CAAA;QAAA,KAAAA,CAAA,CAAAC,gBAAA;UAAA;UAMrC,CAAAV,EAAA,GAAAS,CAAA,CAAAI,aAAqB,qBACzBb,EAAA,CAAAc,KAAA;QACE;MACA;IAAS,GAEX;IACE,MAAAC,kBAAA,GAAAP,oBAAA,CAAAC,CAAA;MAAYnB,IAAA,iBAAAmB,CAAA;MAIhB,OAAAA,CAAA,CAAAC,gBAAA;IAEI,GAAAC,SAAA,CAAAF,CAAA;MACAL,WAAA,CAAAK,CAAA;IAAS,GAEX;IACE,MAAIO,WAAA,GAAAR,oBAAA,CAAAC,CAAA;MACFnB,IAAE,UAAAmB,CAAA;MACF,OAAAA,CAAA,CAAAC,gBAAA;IAAA,GAAAD,CAAA;MAEF,IAAIT,EAAA,EAAAC,EAAA,EAAAgB,EAAA;MACF,IAAA/B,KAAA,CAAA0B,QAAA;QAAWH,CAAA,CAAAS,wBAAA;QAEb;MAAsD;MAK1D,IAAM,CAAAlB,EAAA,GAAAR,UAAgB,oBAAAA,UAAA,CAAA2B,WAAA,qBAAAnB,EAAA,CAAAoB,KAAA;QACpB,CAAAnB,EAAA,GAAAT,UAAA,CAAAwB,WAAA,qBAAAf,EAAA,CAAAoB,IAAA,CAAA7B,UAAA;MAAsB;MAGxB,CAAAyB,EAAA,GAAAzB,UAAA,CAAA8B,cAAA,qBAAAL,EAAA,CAAAI,IAAA,CAAA7B,UAAA,EAAAN,KAAA,CAAAqC,OAAA,EAAA7B,SAAA,EAAAe,CAAA;IAAO,EACL;IAAA,MAAAe,aAAA,GAAAzB,QAAA;MAEA;QAAA,GAAAb,KAAA;QAAA,GAAAK;MAAA;IAAA,EACA;IAAA;MACAyB,WAAA;MAAAT,iBAAA;MAAAQ,kBAAA;;;;;;AA5GiB,SAAAU,YAAAC,IAAA,EAAAC,MAAA,EAAAC,MAAA,EAAAC,MAAA,EAAAC,KAAA,EAAAC,QAAA;EACN,IAAA/B,EAAA;;;EAWU,MAAAgC,sCAAA,GAAAC,gBAAA;EAToB,OAAAC,SAAA,IAAAC,WAAA,CAAAH,sCAAA;;;EAQjB;IALWI,OAAA,EAAAC,OAAA,OACnB,CAAAC,WAAA,CAAAC,+BAAA;MACNC,SAAA,GAAAd,IAAA,CAAAd;;8BAEA0B,WAAA,CAAAG,gCAAA,EAAAC,UAAA,CAAAhB,IAAA,CAAAF,aAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}