{"ast":null,"code":"import { inject, computed } from 'vue';\nimport '../../../utils/index.mjs';\nimport { throwError } from '../../../utils/error.mjs';\nfunction useMenu(instance, currentIndex) {\n  const rootMenu = inject(\"rootMenu\");\n  if (!rootMenu) throwError(\"useMenu\", \"can not inject root menu\");\n  const indexPath = computed(() => {\n    let parent = instance.parent;\n    const path = [currentIndex.value];\n    while (parent.type.name !== \"TwMenu\") {\n      if (parent.props.index) {\n        path.unshift(parent.props.index);\n      }\n      parent = parent.parent;\n    }\n    return path;\n  });\n  const parentMenu = computed(() => {\n    let parent = instance.parent;\n    while (parent && ![\"TwMenu\", \"TwSubMenu\"].includes(parent.type.name)) {\n      parent = parent.parent;\n    }\n    return parent;\n  });\n  const paddingStyle = computed(() => {\n    let parent = instance.parent;\n    if (rootMenu.props.mode !== \"vertical\") return {};\n    let padding = 20;\n    if (rootMenu.props.collapse) {\n      padding = 20;\n    } else {\n      while (parent && parent.type.name !== \"TwMenu\") {\n        if (parent.type.name === \"TwSubMenu\") {\n          padding += 20;\n        }\n        parent = parent.parent;\n      }\n    }\n    return {\n      paddingLeft: `${padding}px`\n    };\n  });\n  return {\n    parentMenu,\n    paddingStyle,\n    indexPath\n  };\n}\nexport { useMenu as default };","map":{"version":3,"names":["useMenu","instance","currentIndex","rootMenu","inject","throwError","indexPath","computed","parent","path","value","type","name","props","index","unshift","parentMenu","includes","paddingStyle","mode","padding","collapse","paddingLeft"],"sources":["/home/bonami/Desktop/Projects/ECommerce/packages/components/menu/src/use-menu.ts"],"sourcesContent":["import { computed, inject } from 'vue'\nimport { throwError } from '@tw-element/utils'\n\nimport type { ComponentInternalInstance, Ref, CSSProperties } from 'vue'\nimport type { MenuProvider } from './types'\n\nexport default function useMenu(\n  instance: ComponentInternalInstance,\n  currentIndex: Ref<string>\n) {\n  const rootMenu = inject<MenuProvider>('rootMenu')\n  if (!rootMenu) throwError('useMenu', 'can not inject root menu')\n\n  const indexPath = computed(() => {\n    let parent = instance.parent!\n    const path = [currentIndex.value]\n    while (parent.type.name !== 'TwMenu') {\n      if (parent.props.index) {\n        path.unshift(parent.props.index as string)\n      }\n      parent = parent.parent!\n    }\n    return path\n  })\n\n  const parentMenu = computed(() => {\n    let parent = instance.parent\n    while (parent && !['TwMenu', 'TwSubMenu'].includes(parent.type.name!)) {\n      parent = parent.parent\n    }\n    return parent!\n  })\n  const paddingStyle = computed<CSSProperties>(() => {\n    let parent = instance.parent\n    if (rootMenu.props.mode !== 'vertical') return {}\n\n    let padding = 20\n\n    if (rootMenu.props.collapse) {\n      padding = 20\n    } else {\n      while (parent && parent.type.name !== 'TwMenu') {\n        if (parent.type.name === 'TwSubMenu') {\n          padding += 20\n        }\n        parent = parent.parent\n      }\n    }\n    return { paddingLeft: `${padding}px` }\n  })\n\n  return {\n    parentMenu,\n    paddingStyle,\n    indexPath,\n  }\n}\n"],"mappings":";;;AAEe,SAASA,OAAOA,CAACC,QAAQ,EAAEC,YAAY,EAAE;EACtD,MAAMC,QAAQ,GAAGC,MAAM,CAAC,UAAU,CAAC;EACnC,IAAI,CAACD,QAAQ,EACXE,UAAU,CAAC,SAAS,EAAE,0BAA0B,CAAC;EACnD,MAAMC,SAAS,GAAGC,QAAQ,CAAC,MAAM;IAC/B,IAAIC,MAAM,GAAGP,QAAQ,CAACO,MAAM;IAC5B,MAAMC,IAAI,GAAG,CAACP,YAAY,CAACQ,KAAK,CAAC;IACjC,OAAOF,MAAM,CAACG,IAAI,CAACC,IAAI,KAAK,QAAQ,EAAE;MACpC,IAAIJ,MAAM,CAACK,KAAK,CAACC,KAAK,EAAE;QACtBL,IAAI,CAACM,OAAO,CAACP,MAAM,CAACK,KAAK,CAACC,KAAK,CAAC;MACxC;MACMN,MAAM,GAAGA,MAAM,CAACA,MAAM;IAC5B;IACI,OAAOC,IAAI;EACf,CAAG,CAAC;EACF,MAAMO,UAAU,GAAGT,QAAQ,CAAC,MAAM;IAChC,IAAIC,MAAM,GAAGP,QAAQ,CAACO,MAAM;IAC5B,OAAOA,MAAM,IAAI,CAAC,CAAC,QAAQ,EAAE,WAAW,CAAC,CAACS,QAAQ,CAACT,MAAM,CAACG,IAAI,CAACC,IAAI,CAAC,EAAE;MACpEJ,MAAM,GAAGA,MAAM,CAACA,MAAM;IAC5B;IACI,OAAOA,MAAM;EACjB,CAAG,CAAC;EACF,MAAMU,YAAY,GAAGX,QAAQ,CAAC,MAAM;IAClC,IAAIC,MAAM,GAAGP,QAAQ,CAACO,MAAM;IAC5B,IAAIL,QAAQ,CAACU,KAAK,CAACM,IAAI,KAAK,UAAU,EACpC,OAAO,EAAE;IACX,IAAIC,OAAO,GAAG,EAAE;IAChB,IAAIjB,QAAQ,CAACU,KAAK,CAACQ,QAAQ,EAAE;MAC3BD,OAAO,GAAG,EAAE;IAClB,CAAK,MAAM;MACL,OAAOZ,MAAM,IAAIA,MAAM,CAACG,IAAI,CAACC,IAAI,KAAK,QAAQ,EAAE;QAC9C,IAAIJ,MAAM,CAACG,IAAI,CAACC,IAAI,KAAK,WAAW,EAAE;UACpCQ,OAAO,IAAI,EAAE;QACvB;QACQZ,MAAM,GAAGA,MAAM,CAACA,MAAM;MAC9B;IACA;IACI,OAAO;MAAEc,WAAW,EAAG,GAAEF,OAAQ;IAAG,CAAE;EAC1C,CAAG,CAAC;EACF,OAAO;IACLJ,UAAU;IACVE,YAAY;IACZZ;EACJ,CAAG;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}