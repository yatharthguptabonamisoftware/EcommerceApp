{"ast":null,"code":"import { ref, watchEffect, watch, unref, computed, onMounted, nextTick, onBeforeUnmount } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { parseHeight } from '../util.mjs';\nimport { addResizeListener, removeResizeListener } from '../../../../utils/dom/resize-event.mjs';\nimport { on, off } from '../../../../utils/dom/event.mjs';\nimport { useSize } from '../../../../hooks/use-common-props/index.mjs';\nimport { isString } from '@vue/shared';\nimport { isNumber } from '@vueuse/core';\nfunction useStyle(props, layout, store, table) {\n  const isHidden = ref(false);\n  const renderExpanded = ref(null);\n  const resizeProxyVisible = ref(false);\n  const setDragVisible = visible => {\n    resizeProxyVisible.value = visible;\n  };\n  const resizeState = ref({\n    width: null,\n    height: null\n  });\n  const isGroup = ref(false);\n  watchEffect(() => {\n    layout.setHeight(props.height);\n  });\n  watchEffect(() => {\n    layout.setMaxHeight(props.maxHeight);\n  });\n  watch(() => [props.currentRowKey, store.states.rowKey], ([currentRowKey, rowKey]) => {\n    if (!unref(rowKey)) return;\n    store.setCurrentRowKey(`${currentRowKey}`);\n  }, {\n    immediate: true\n  });\n  watch(() => props.data, data => {\n    table.store.commit(\"setData\", data);\n  }, {\n    immediate: true,\n    deep: true\n  });\n  watchEffect(() => {\n    if (props.expandRowKeys) {\n      store.setExpandRowKeysAdapter(props.expandRowKeys);\n    }\n  });\n  const handleMouseLeave = () => {\n    table.store.commit(\"setHoverRow\", null);\n    if (table.hoverState) table.hoverState = null;\n  };\n  const handleHeaderFooterMousewheel = (event, data) => {\n    const {\n      pixelX,\n      pixelY\n    } = data;\n    if (Math.abs(pixelX) >= Math.abs(pixelY)) {\n      table.refs.bodyWrapper.scrollLeft += data.pixelX / 5;\n    }\n  };\n  const shouldUpdateHeight = computed(() => {\n    return props.height || props.maxHeight || store.states.fixedColumns.value.length > 0 || store.states.rightFixedColumns.value.length > 0;\n  });\n  const tableBodyStyles = computed(() => {\n    return {\n      width: layout.bodyWidth.value ? `${layout.bodyWidth.value}px` : \"\"\n    };\n  });\n  const doLayout = () => {\n    if (shouldUpdateHeight.value) {\n      layout.updateElsHeight();\n    }\n    layout.updateColumnsWidth();\n    requestAnimationFrame(syncPostion);\n  };\n  onMounted(async () => {\n    setScrollClass(\"is-scrolling-left\");\n    store.updateColumns();\n    await nextTick();\n    bindEvents();\n    requestAnimationFrame(doLayout);\n    resizeState.value = {\n      width: table.vnode.el.offsetWidth,\n      height: table.vnode.el.offsetHeight\n    };\n    store.states.columns.value.forEach(column => {\n      if (column.filteredValue && column.filteredValue.length) {\n        table.store.commit(\"filterChange\", {\n          column,\n          values: column.filteredValue,\n          silent: true\n        });\n      }\n    });\n    table.$ready = true;\n  });\n  const setScrollClassByEl = (el, className) => {\n    if (!el) return;\n    const classList = Array.from(el.classList).filter(item => !item.startsWith(\"is-scrolling-\"));\n    classList.push(layout.scrollX.value ? className : \"is-scrolling-none\");\n    el.className = classList.join(\" \");\n  };\n  const setScrollClass = className => {\n    const {\n      tableWrapper\n    } = table.refs;\n    setScrollClassByEl(tableWrapper, className);\n  };\n  const syncPostion = function () {\n    if (!table.refs.scrollWrapper) return;\n    const scrollContainer = table.refs.scrollWrapper.wrap$;\n    if (!scrollContainer) return;\n    const {\n      scrollLeft,\n      offsetWidth,\n      scrollWidth\n    } = scrollContainer;\n    const {\n      headerWrapper,\n      footerWrapper\n    } = table.refs;\n    if (headerWrapper) headerWrapper.scrollLeft = scrollLeft;\n    if (footerWrapper) footerWrapper.scrollLeft = scrollLeft;\n    const maxScrollLeftPosition = scrollWidth - offsetWidth - 1;\n    if (scrollLeft >= maxScrollLeftPosition) {\n      setScrollClass(\"is-scrolling-right\");\n    } else if (scrollLeft === 0) {\n      setScrollClass(\"is-scrolling-left\");\n    } else {\n      setScrollClass(\"is-scrolling-middle\");\n    }\n  };\n  const bindEvents = () => {\n    var _a;\n    if (!table.refs.scrollWrapper) return;\n    (_a = table.refs.scrollWrapper.wrap$) == null ? void 0 : _a.addEventListener(\"scroll\", syncPostion, {\n      passive: true\n    });\n    if (props.fit) {\n      addResizeListener(table.vnode.el, resizeListener);\n    } else {\n      on(window, \"resize\", doLayout);\n    }\n  };\n  onBeforeUnmount(() => {\n    unbindEvents();\n  });\n  const unbindEvents = () => {\n    var _a;\n    (_a = table.refs.scrollWrapper.wrap$) == null ? void 0 : _a.removeEventListener(\"scroll\", syncPostion, true);\n    if (props.fit) {\n      removeResizeListener(table.vnode.el, resizeListener);\n    } else {\n      off(window, \"resize\", doLayout);\n    }\n  };\n  const resizeListener = () => {\n    if (!table.$ready) return;\n    let shouldUpdateLayout = false;\n    const el = table.vnode.el;\n    const {\n      width: oldWidth,\n      height: oldHeight\n    } = resizeState.value;\n    const width = el.offsetWidth;\n    if (oldWidth !== width) {\n      shouldUpdateLayout = true;\n    }\n    const height2 = el.offsetHeight;\n    if ((props.height || shouldUpdateHeight.value) && oldHeight !== height2) {\n      shouldUpdateLayout = true;\n    }\n    if (shouldUpdateLayout) {\n      resizeState.value = {\n        width,\n        height: height2\n      };\n      doLayout();\n    }\n  };\n  const tableSize = useSize();\n  const bodyWidth = computed(() => {\n    const {\n      bodyWidth: bodyWidth_,\n      scrollY,\n      gutterWidth\n    } = layout;\n    return bodyWidth_.value ? `${bodyWidth_.value - (scrollY.value ? gutterWidth : 0)}px` : \"\";\n  });\n  const tableLayout = computed(() => {\n    if (props.maxHeight) return \"fixed\";\n    return props.tableLayout;\n  });\n  function calcMaxHeight(maxHeight, footerHeight, headerHeight) {\n    const parsedMaxHeight = parseHeight(maxHeight);\n    const tableHeaderHeight = props.showHeader ? headerHeight : 0;\n    if (parsedMaxHeight === null) return;\n    if (isString(parsedMaxHeight)) {\n      return `calc(${parsedMaxHeight} - ${footerHeight}px - ${tableHeaderHeight}px)`;\n    }\n    return parsedMaxHeight - footerHeight - tableHeaderHeight;\n  }\n  const height = computed(() => {\n    const headerHeight = layout.headerHeight.value || 0;\n    const bodyHeight2 = layout.bodyHeight.value;\n    const footerHeight = layout.footerHeight.value || 0;\n    if (props.height) {\n      return bodyHeight2 ? bodyHeight2 : void 0;\n    } else if (props.maxHeight) {\n      return calcMaxHeight(props.maxHeight, footerHeight, headerHeight);\n    }\n    return void 0;\n  });\n  const bodyHeight = computed(() => {\n    const headerHeight = layout.headerHeight.value || 0;\n    const bodyHeight2 = layout.bodyHeight.value;\n    const footerHeight = layout.footerHeight.value || 0;\n    if (props.height) {\n      return {\n        height: bodyHeight2 ? `${bodyHeight2}px` : \"\"\n      };\n    } else if (props.maxHeight) {\n      const maxHeight = calcMaxHeight(props.maxHeight, footerHeight, headerHeight);\n      if (maxHeight !== null) {\n        return {\n          \"max-height\": `${maxHeight}${isNumber(maxHeight) ? \"px\" : \"\"}`\n        };\n      }\n    }\n    return {};\n  });\n  const emptyBlockStyle = computed(() => {\n    if (props.data && props.data.length) return null;\n    let height2 = \"100%\";\n    if (layout.appendHeight.value) {\n      height2 = `calc(100% - ${layout.appendHeight.value}px)`;\n    }\n    return {\n      width: bodyWidth.value,\n      height: height2\n    };\n  });\n  const handleFixedMousewheel = (event, data) => {\n    const bodyWrapper = table.refs.bodyWrapper;\n    if (Math.abs(data.spinY) > 0) {\n      const currentScrollTop = bodyWrapper.scrollTop;\n      if (data.pixelY < 0 && currentScrollTop !== 0) {\n        event.preventDefault();\n      }\n      if (data.pixelY > 0 && bodyWrapper.scrollHeight - bodyWrapper.clientHeight > currentScrollTop) {\n        event.preventDefault();\n      }\n      bodyWrapper.scrollTop += Math.ceil(data.pixelY / 5);\n    } else {\n      bodyWrapper.scrollLeft += Math.ceil(data.pixelX / 5);\n    }\n  };\n  const fixedHeight = computed(() => {\n    if (props.maxHeight) {\n      if (props.showSummary) {\n        return {\n          bottom: 0\n        };\n      }\n      return {\n        bottom: layout.scrollX.value && props.data.length ? `${layout.gutterWidth}px` : \"\"\n      };\n    } else {\n      if (props.showSummary) {\n        return {\n          height: layout.tableHeight.value ? `${layout.tableHeight.value}px` : \"\"\n        };\n      }\n      return {\n        height: layout.viewportHeight.value ? `${layout.viewportHeight.value}px` : \"\"\n      };\n    }\n  });\n  const fixedBodyHeight = computed(() => {\n    if (props.height) {\n      return {\n        height: layout.fixedBodyHeight.value ? `${layout.fixedBodyHeight.value}px` : \"\"\n      };\n    } else if (props.maxHeight) {\n      let maxHeight = parseHeight(props.maxHeight);\n      if (typeof maxHeight === \"number\") {\n        maxHeight = layout.scrollX.value ? maxHeight - layout.gutterWidth : maxHeight;\n        if (props.showHeader) {\n          maxHeight -= layout.headerHeight.value;\n        }\n        maxHeight -= layout.footerHeight.value;\n        return {\n          \"max-height\": `${maxHeight}px`\n        };\n      }\n    }\n    return {};\n  });\n  return {\n    isHidden,\n    renderExpanded,\n    setDragVisible,\n    isGroup,\n    handleMouseLeave,\n    handleHeaderFooterMousewheel,\n    tableSize,\n    bodyHeight,\n    height,\n    emptyBlockStyle,\n    handleFixedMousewheel,\n    fixedHeight,\n    fixedBodyHeight,\n    resizeProxyVisible,\n    bodyWidth,\n    resizeState,\n    doLayout,\n    tableBodyStyles,\n    tableLayout\n  };\n}\nexport { useStyle as default };","map":{"version":3,"names":["useStyle","props","layout","store","table","isHidden","ref","renderExpanded","resizeProxyVisible","setDragVisible","visible","value","resizeState","width","height","isGroup","watchEffect","setHeight","setMaxHeight","maxHeight","watch","currentRowKey","states","rowKey","unref","setCurrentRowKey","immediate","data","commit","deep","expandRowKeys","setExpandRowKeysAdapter","handleMouseLeave","hoverState","handleHeaderFooterMousewheel","event","pixelX","pixelY","Math","abs","refs","bodyWrapper","scrollLeft","shouldUpdateHeight","computed","fixedColumns","length","rightFixedColumns","tableBodyStyles","bodyWidth","doLayout","updateElsHeight","updateColumnsWidth","requestAnimationFrame","syncPostion","onMounted","setScrollClass","updateColumns","nextTick","bindEvents","vnode","el","offsetWidth","offsetHeight","columns","forEach","column","filteredValue","values","silent","$ready","setScrollClassByEl","className","classList","Array","from","filter","item","startsWith","push","scrollX","join","tableWrapper","scrollWrapper","scrollContainer","wrap$","scrollWidth","headerWrapper","footerWrapper","maxScrollLeftPosition","_a","addEventListener","passive","fit","addResizeListener","resizeListener","on","window","onBeforeUnmount","unbindEvents","removeEventListener","removeResizeListener","off","shouldUpdateLayout","oldWidth","oldHeight","height2","tableSize","useSize","bodyWidth_","scrollY","gutterWidth","tableLayout","calcMaxHeight","footerHeight","headerHeight","parsedMaxHeight","parseHeight","tableHeaderHeight","showHeader","isString","bodyHeight2","bodyHeight","isNumber","emptyBlockStyle","appendHeight","handleFixedMousewheel","spinY","currentScrollTop","scrollTop","preventDefault","scrollHeight","clientHeight","ceil","fixedHeight","showSummary","bottom","tableHeight","viewportHeight","fixedBodyHeight"],"sources":["/home/bonami/Desktop/Projects/ECommerce/packages/components/table/src/table/style-helper.ts"],"sourcesContent":["import {\n  onMounted,\n  onBeforeUnmount,\n  computed,\n  ref,\n  watchEffect,\n  watch,\n  unref,\n  nextTick,\n} from 'vue'\nimport {\n  addResizeListener,\n  removeResizeListener,\n  on,\n  off,\n  isNumber,\n  isString,\n} from '@tw-element/utils'\nimport { useSize } from '@tw-element/hooks'\nimport { parseHeight } from '../util'\n\nimport type { ResizableElement } from '@tw-element/utils'\nimport type { Table, TableProps } from './defaults'\nimport type { Store } from '../store'\nimport type TableLayout from '../table-layout'\nimport type { TableColumnCtx } from '../table-column/defaults'\n\nfunction useStyle<T>(\n  props: TableProps<T>,\n  layout: TableLayout<T>,\n  store: Store<T>,\n  table: Table<T>\n) {\n  const isHidden = ref(false)\n  const renderExpanded = ref(null)\n  const resizeProxyVisible = ref(false)\n  const setDragVisible = (visible: boolean) => {\n    resizeProxyVisible.value = visible\n  }\n  const resizeState = ref({\n    width: null,\n    height: null,\n  })\n  const isGroup = ref(false)\n\n  watchEffect(() => {\n    layout.setHeight(props.height)\n  })\n  watchEffect(() => {\n    layout.setMaxHeight(props.maxHeight)\n  })\n  watch(\n    () => [props.currentRowKey, store.states.rowKey],\n    ([currentRowKey, rowKey]) => {\n      if (!unref(rowKey)) return\n      store.setCurrentRowKey(`${currentRowKey}`)\n    },\n    {\n      immediate: true,\n    }\n  )\n  watch(\n    () => props.data,\n    (data) => {\n      table.store.commit('setData', data)\n    },\n    {\n      immediate: true,\n      deep: true,\n    }\n  )\n  watchEffect(() => {\n    if (props.expandRowKeys) {\n      store.setExpandRowKeysAdapter(props.expandRowKeys)\n    }\n  })\n\n  const handleMouseLeave = () => {\n    table.store.commit('setHoverRow', null)\n    if (table.hoverState) table.hoverState = null\n  }\n\n  const handleHeaderFooterMousewheel = (event, data) => {\n    const { pixelX, pixelY } = data\n    if (Math.abs(pixelX) >= Math.abs(pixelY)) {\n      table.refs.bodyWrapper.scrollLeft += data.pixelX / 5\n    }\n  }\n\n  const shouldUpdateHeight = computed(() => {\n    return (\n      props.height ||\n      props.maxHeight ||\n      store.states.fixedColumns.value.length > 0 ||\n      store.states.rightFixedColumns.value.length > 0\n    )\n  })\n\n  const tableBodyStyles = computed(() => {\n    return {\n      width: layout.bodyWidth.value ? `${layout.bodyWidth.value}px` : '',\n    }\n  })\n\n  const doLayout = () => {\n    if (shouldUpdateHeight.value) {\n      layout.updateElsHeight()\n    }\n    layout.updateColumnsWidth()\n    requestAnimationFrame(syncPostion)\n  }\n  onMounted(async () => {\n    setScrollClass('is-scrolling-left')\n    store.updateColumns()\n    await nextTick()\n    bindEvents()\n    requestAnimationFrame(doLayout)\n\n    resizeState.value = {\n      width: table.vnode.el.offsetWidth,\n      height: table.vnode.el.offsetHeight,\n    }\n\n    // init filters\n    store.states.columns.value.forEach((column: TableColumnCtx<T>) => {\n      if (column.filteredValue && column.filteredValue.length) {\n        table.store.commit('filterChange', {\n          column,\n          values: column.filteredValue,\n          silent: true,\n        })\n      }\n    })\n    table.$ready = true\n  })\n  const setScrollClassByEl = (el: HTMLElement, className: string) => {\n    if (!el) return\n    const classList = Array.from(el.classList).filter(\n      (item) => !item.startsWith('is-scrolling-')\n    )\n    classList.push(layout.scrollX.value ? className : 'is-scrolling-none')\n    el.className = classList.join(' ')\n  }\n  const setScrollClass = (className: string) => {\n    const { tableWrapper } = table.refs\n    setScrollClassByEl(tableWrapper, className)\n  }\n  const syncPostion = function () {\n    if (!table.refs.scrollWrapper) return\n    const scrollContainer = table.refs.scrollWrapper.wrap$\n    if (!scrollContainer) return\n    const { scrollLeft, offsetWidth, scrollWidth } = scrollContainer\n    const { headerWrapper, footerWrapper } = table.refs\n    if (headerWrapper) headerWrapper.scrollLeft = scrollLeft\n    if (footerWrapper) footerWrapper.scrollLeft = scrollLeft\n    const maxScrollLeftPosition = scrollWidth - offsetWidth - 1\n    if (scrollLeft >= maxScrollLeftPosition) {\n      setScrollClass('is-scrolling-right')\n    } else if (scrollLeft === 0) {\n      setScrollClass('is-scrolling-left')\n    } else {\n      setScrollClass('is-scrolling-middle')\n    }\n  }\n\n  const bindEvents = () => {\n    if (!table.refs.scrollWrapper) return\n    table.refs.scrollWrapper.wrap$?.addEventListener('scroll', syncPostion, {\n      passive: true,\n    })\n    if (props.fit) {\n      addResizeListener(table.vnode.el as ResizableElement, resizeListener)\n    } else {\n      on(window, 'resize', doLayout)\n    }\n  }\n  onBeforeUnmount(() => {\n    unbindEvents()\n  })\n  const unbindEvents = () => {\n    table.refs.scrollWrapper.wrap$?.removeEventListener(\n      'scroll',\n      syncPostion,\n      true\n    )\n    if (props.fit) {\n      removeResizeListener(table.vnode.el as ResizableElement, resizeListener)\n    } else {\n      off(window, 'resize', doLayout)\n    }\n  }\n  const resizeListener = () => {\n    if (!table.$ready) return\n    let shouldUpdateLayout = false\n    const el = table.vnode.el\n    const { width: oldWidth, height: oldHeight } = resizeState.value\n\n    const width = el.offsetWidth\n    if (oldWidth !== width) {\n      shouldUpdateLayout = true\n    }\n\n    const height = el.offsetHeight\n    if ((props.height || shouldUpdateHeight.value) && oldHeight !== height) {\n      shouldUpdateLayout = true\n    }\n\n    if (shouldUpdateLayout) {\n      resizeState.value = {\n        width,\n        height,\n      }\n      doLayout()\n    }\n  }\n  const tableSize = useSize()\n  const bodyWidth = computed(() => {\n    const { bodyWidth: bodyWidth_, scrollY, gutterWidth } = layout\n    return bodyWidth_.value\n      ? `${(bodyWidth_.value as number) - (scrollY.value ? gutterWidth : 0)}px`\n      : ''\n  })\n\n  const tableLayout = computed(() => {\n    if (props.maxHeight) return 'fixed'\n    return props.tableLayout\n  })\n\n  function calcMaxHeight(\n    maxHeight: string | number,\n    footerHeight: number,\n    headerHeight: number\n  ) {\n    const parsedMaxHeight = parseHeight(maxHeight)\n    const tableHeaderHeight = props.showHeader ? headerHeight : 0\n    if (parsedMaxHeight === null) return\n    if (isString(parsedMaxHeight)) {\n      return `calc(${parsedMaxHeight} - ${footerHeight}px - ${tableHeaderHeight}px)`\n    }\n    return parsedMaxHeight - footerHeight - tableHeaderHeight\n  }\n\n  const height = computed(() => {\n    const headerHeight = layout.headerHeight.value || 0\n    const bodyHeight = layout.bodyHeight.value\n    const footerHeight = layout.footerHeight.value || 0\n    if (props.height) {\n      return bodyHeight ? bodyHeight : undefined\n    } else if (props.maxHeight) {\n      return calcMaxHeight(props.maxHeight, footerHeight, headerHeight)\n    }\n    return undefined\n  })\n\n  const bodyHeight = computed(() => {\n    const headerHeight = layout.headerHeight.value || 0\n    const bodyHeight = layout.bodyHeight.value\n    const footerHeight = layout.footerHeight.value || 0\n    if (props.height) {\n      return {\n        height: bodyHeight ? `${bodyHeight}px` : '',\n      }\n    } else if (props.maxHeight) {\n      const maxHeight = calcMaxHeight(\n        props.maxHeight,\n        footerHeight,\n        headerHeight\n      )\n      if (maxHeight !== null) {\n        return {\n          'max-height': `${maxHeight}${isNumber(maxHeight) ? 'px' : ''}`,\n        }\n      }\n    }\n    return {}\n  })\n  const emptyBlockStyle = computed(() => {\n    if (props.data && props.data.length) return null\n    let height = '100%'\n    if (layout.appendHeight.value) {\n      height = `calc(100% - ${layout.appendHeight.value}px)`\n    }\n    return {\n      width: bodyWidth.value,\n      height,\n    }\n  })\n  /**\n   * fix layout\n   */\n  const handleFixedMousewheel = (event, data) => {\n    const bodyWrapper = table.refs.bodyWrapper\n    if (Math.abs(data.spinY) > 0) {\n      const currentScrollTop = bodyWrapper.scrollTop\n      if (data.pixelY < 0 && currentScrollTop !== 0) {\n        event.preventDefault()\n      }\n      if (\n        data.pixelY > 0 &&\n        bodyWrapper.scrollHeight - bodyWrapper.clientHeight > currentScrollTop\n      ) {\n        event.preventDefault()\n      }\n      bodyWrapper.scrollTop += Math.ceil(data.pixelY / 5)\n    } else {\n      bodyWrapper.scrollLeft += Math.ceil(data.pixelX / 5)\n    }\n  }\n  const fixedHeight = computed(() => {\n    if (props.maxHeight) {\n      if (props.showSummary) {\n        return {\n          bottom: 0,\n        }\n      }\n      return {\n        bottom:\n          layout.scrollX.value && props.data.length\n            ? `${layout.gutterWidth}px`\n            : '',\n      }\n    } else {\n      if (props.showSummary) {\n        return {\n          height: layout.tableHeight.value\n            ? `${layout.tableHeight.value}px`\n            : '',\n        }\n      }\n      return {\n        height: layout.viewportHeight.value\n          ? `${layout.viewportHeight.value}px`\n          : '',\n      }\n    }\n  })\n  const fixedBodyHeight = computed(() => {\n    if (props.height) {\n      return {\n        height: layout.fixedBodyHeight.value\n          ? `${layout.fixedBodyHeight.value}px`\n          : '',\n      }\n    } else if (props.maxHeight) {\n      let maxHeight = parseHeight(props.maxHeight)\n      if (typeof maxHeight === 'number') {\n        maxHeight = layout.scrollX.value\n          ? maxHeight - layout.gutterWidth\n          : maxHeight\n        if (props.showHeader) {\n          maxHeight -= layout.headerHeight.value\n        }\n        maxHeight -= layout.footerHeight.value\n        return {\n          'max-height': `${maxHeight}px`,\n        }\n      }\n    }\n    return {}\n  })\n\n  return {\n    isHidden,\n    renderExpanded,\n    setDragVisible,\n    isGroup,\n    handleMouseLeave,\n    handleHeaderFooterMousewheel,\n    tableSize,\n    bodyHeight,\n    height,\n    emptyBlockStyle,\n    handleFixedMousewheel,\n    fixedHeight,\n    fixedBodyHeight,\n    resizeProxyVisible,\n    bodyWidth,\n    resizeState,\n    doLayout,\n    tableBodyStyles,\n    tableLayout,\n  }\n}\n\nexport default useStyle\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}